"use strict";(self.webpackChunkstorybook=self.webpackChunkstorybook||[]).push([[804],{"../../web-component/jb-image-input/react/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>JBImageInput_l});var react=__webpack_require__("./node_modules/react/index.js"),jb_validation=__webpack_require__("../../web-component/jb-validation/dist/jb-validation.js"),t=class{lightness;chroma;hue;variableName;get value(){return`oklch(${this.lightness} ${this.chroma} ${this.hue})`}constructor(e,t){this.variableName=t,this.lightness=e.lightness,this.chroma=e.chroma,this.hue=e.hue}};function a(e){return new t({lightness:6*(3+1.3*e)*.01,chroma:.001*(14+.09*e),hue:258.36},`--jb-neutral-${e}`)}function i(e){return new t({lightness:e.lightness+.07,chroma:e.chroma+.07,hue:e.hue},`${e.variableName}-hover`)}function r(e){return new t({lightness:e.lightness-.1,chroma:e.chroma-.05,hue:e.hue},`${e.variableName}-pressed`)}function n(e){const a=Math.min(e.lightness+.12*(1-e.lightness),.985),i=e.chroma*(1-.15*(a-e.lightness));return new t({lightness:a,chroma:Number(i.toFixed(3)),hue:e.hue},`${e.variableName}-l`)}function l(e){const a=Math.max(e.lightness-.12*e.lightness,.02),i=e.chroma*(1-.15*(a-e.lightness));return new t({lightness:a,chroma:i,hue:e.hue},`${e.variableName}-d`)}function o(e){const a=Math.min(e.lightness+.65*(1-e.lightness),.93),i=.55*e.chroma*(1-.08*(a-e.lightness)),r=e.hue>=70&&e.hue<=162?5:-3,n=e.hue+r;return new t({lightness:a,chroma:Number(i.toFixed(3)),hue:n},`${e.variableName}-subtle`)}function s(e){const a=Math.max(e.lightness-.35,.22),i=Math.min(1.6*e.chroma,.28);return new t({lightness:Number(a.toFixed(3)),chroma:Number(i.toFixed(3)),hue:e.hue},`${e.variableName}-contrast`)}const c=new t({lightness:.6,chroma:.26,hue:256},"--jb-primary"),d=new t({lightness:.6,chroma:.26,hue:286},"--jb-secondary"),h=new t({lightness:.75,chroma:.18,hue:70},"--jb-yellow"),u=new t({lightness:.68,chroma:.1484,hue:162.1},"--jb-green"),p=new t({lightness:.6,chroma:.22,hue:23.21},"--jb-red"),m={single:{black:new t({lightness:.14,chroma:0,hue:0},"--jb-black"),white:new t({lightness:1,chroma:0,hue:0},"--jb-white"),highlight:new t({lightness:.93,chroma:.2302,hue:125.18},"--jb-highlight")},neutral:[a(0),a(1),a(2),a(3),a(4),a(5),a(6),a(7),a(8),a(9),a(10)],primary:{main:c,hover:i(c),pressed:r(c),light:n(c),dark:l(c),subtle:o(c),contrast:s(c)},secondary:{main:d,hover:i(d),pressed:r(d),light:n(d),dark:l(d),subtle:o(d),contrast:s(d)},yellow:{main:h,hover:i(h),pressed:r(h),light:n(h),dark:l(h),subtle:o(h),contrast:s(h)},green:{main:u,hover:i(u),pressed:r(u),light:n(u),dark:l(u),subtle:o(u),contrast:s(u)},red:{main:p,hover:i(p),pressed:r(p),light:n(p),dark:l(p),subtle:o(p),contrast:s(p)}};function g(e){try{window.CSS.registerProperty({...e})}catch(e){}}var b=class t extends HTMLElement{static get formAssociated(){return!0}get value(){return this.#e}set value(e){this.#t(e)}#a=!1;get isAutoValidationDisabled(){return this.#a}set isAutoValidationDisabled(e){this.#a=e}#i=null;#r;#n;get selectedImageType(){return this.#l.type}get status(){return this.#i}get multiple(){return this.#o}set multiple(e){this.#o=e,this.#o?this.#r.setAttribute("multiple","multiple"):this.#r.removeAttribute("multiple")}#s="image/jpeg,image/jpg,image/png,image/svg+xml";get acceptTypes(){return this.#s}set acceptTypes(e){this.#s=e,this.#r&&(this.#r.accept=e)}#c=null;#e=null;#l=null;#d=null;get file(){return this.#l}imageBase64Value=null;get maxFileSize(){return this.#c}set maxFileSize(e){null==e?this.#c=null:isNaN(e)||"number"!=typeof e||(this.#c=e)}#h=!1;get disabled(){return this.#h}set disabled(e){this.#h=e,e?this.#u.states?.add("disabled"):this.#u.states?.delete("disabled")}#p=!1;set required(e){this.#p=e,this.#m.checkValidity({showError:!1})}get required(){return this.#p}#u;#m=new jb_validation.EQ({showValidationError:this.showValidationError.bind(this),clearValidationError:this.clearValidationError.bind(this),getValue:()=>({file:this.#l,value:this.#e}),getValidations:this.#g.bind(this),setValidationResult:this.#b.bind(this),getValueString:()=>this.fileName});get validation(){return this.#m}get name(){return this.getAttribute("name")||""}initialValue=null;get isDirty(){return this.#e!==this.initialValue}constructor(){super(),"function"==typeof this.attachInternals&&(this.#u=this.attachInternals()),this.#v(),this.#w(),this.#y()}get fileName(){return this.#l.name}#v(){const e=this.attachShadow({mode:"open",delegatesFocus:!0});var t;(function(e){g({name:e.primary.main.variableName,syntax:"<color>",inherits:!0,initialValue:e.primary.main.value}),g({name:e.secondary.main.variableName,syntax:"<color>",inherits:!0,initialValue:e.secondary.main.value}),g({name:"--jb-neutral",syntax:"<color>",inherits:!0,initialValue:e.neutral[0].value}),g({name:e.single.black.variableName,syntax:"<color>",inherits:!0,initialValue:e.single.black.value}),g({name:e.single.white.variableName,syntax:"<color>",inherits:!0,initialValue:e.single.white.value}),g({name:e.single.highlight.variableName,syntax:"<color>",inherits:!0,initialValue:e.single.highlight.value}),g({name:e.yellow.main.variableName,syntax:"<color>",inherits:!0,initialValue:e.yellow.main.value}),g({name:e.green.main.variableName,syntax:"<color>",inherits:!0,initialValue:e.green.main.value}),g({name:e.red.main.variableName,syntax:"<color>",inherits:!0,initialValue:e.red.main.value}),g({name:"--jb-neutral",syntax:"<color>",inherits:!0,initialValue:e.neutral[0].value});for(let t=1;t<=10;t++)g({name:e.neutral[t].variableName,syntax:"<color>",inherits:!0,initialValue:e.neutral[t].value})})(m),g({name:"--jb-text-primary",syntax:"<color>",inherits:!0,initialValue:(t=m).single.black.value}),g({name:"--jb-text-secondary",syntax:"<color>",inherits:!0,initialValue:t.neutral[7].value}),g({name:"--jb-text-contrast",syntax:"<color>",inherits:!0,initialValue:t.single.white.value});const a=document.createElement("template");a.innerHTML='<style>:host{--bg-color:var(--jb-image-input-bg-color, var(--jb-neutral-10));--placeholder-neutral-color: var(--jb-image-input-placeholder-p-color, var(--jb-neutral));--placeholder-primary-color: var(--jb-image-input-placeholder-sec-color, var(--jb-primary));--placeholder-title-color:var(--jb-image-input-placeholder-title-color, var(--jb-neutral));--message-color:var(--jb-image-input-message-color, var(--jb-text-secondary));--message-error-color:var(--jb-image-input-message-error-color, var(--jb-red));--overlay-bg-color:oklch(from var(--jb-neutral) l c h / calc(alpha - 0.5));--delete-button-color:var(--jb-red);--delete-button-bg-color:var(--jb-white);--delete-icon-color:var(--jb-red);--download-button-color:var(--jb-white);--download-button--bg-color-hover:var(--jb-white);--download-button-color-hover:var(--jb-neutral);--reselect-button-color:var(--jb-white);--error-overlay-bg-color:oklch(from var(--jb-red) l c h / calc(alpha - 0.5));--error-overlay-color:var(--jb-white);--error-overlay-icon-color:var(--jb-white);--error-overlay-outline:var(--jb-black)}:host{--border-radius: var(--jb-image-input-border-radius, 1.5rem);width:var(--jb-image-input-width, 100%);height:var(--jb-image-input-height, 100%)}.jb-image-input-web-component{position:relative;background-color:var(--bg-color);width:100%;height:100%;border-radius:var(--border-radius);display:flex;justify-content:center;align-items:center;overflow:hidden;box-sizing:border-box}.jb-image-input-web-component[status=empty] .placeholder-wrapper{display:flex}.jb-image-input-web-component .placeholder-wrapper{width:100%;height:100%;display:none;cursor:pointer;background-color:var(--jb-image-input-placeholder-bg-color, transparent)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder{width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;gap:.25rem;padding:.5rem}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .icon-wrapper svg{width:64px;height:64px;fill:var(--placeholder-neutral-color)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .icon-wrapper svg .cls-1{fill:var(--placeholder-primary-color)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .placeholder-title{color:var(--placeholder-title-color);font-variation-settings:"wght" 600}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .message-box{font-size:var(--jb-image-input-message-font-size, 0.7rem);padding:2px 8px;color:var(--message-color);display:var(--jb-image-input-message-box-display, block)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .message-box:empty{padding:0}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .message-box.error{color:var(--message-error-color)}.jb-image-input-web-component[status=uploading] .upload-loading-wrapper{display:flex}.jb-image-input-web-component .upload-loading-wrapper{display:none}.jb-image-input-web-component[status=uploaded] .download-loading-wrapper{display:flex}.jb-image-input-web-component .download-loading-wrapper{display:none}.jb-image-input-web-component[status=downloaded] .image-wrapper{display:block}.jb-image-input-web-component[status=downloaded] .image-wrapper img{object-fit:contain;width:100%;height:100%}.jb-image-input-web-component .image-wrapper{position:relative;display:none;width:100%;height:100%;object-fit:contain}.jb-image-input-web-component .image-wrapper:hover .image-overlay{opacity:1}.jb-image-input-web-component .image-wrapper .image-overlay{cursor:pointer;opacity:0;transition:all .3s 0s ease;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--overlay-bg-color);backdrop-filter:blur(8px);z-index:1;overflow:hidden;border-radius:var(--border-radius);display:flex;justify-content:center;align-items:center;gap:1rem;flex-wrap:wrap}.jb-image-input-web-component .image-wrapper .image-overlay .delete-button{background-color:rgba(0,0,0,0);color:var(--delete-button-color);border-radius:1rem;width:2.5rem;height:2.5rem;display:flex;justify-content:center;align-items:center}.jb-image-input-web-component .image-wrapper .image-overlay .delete-button:hover{background-color:var(--delete-button-bg-color)}.jb-image-input-web-component .image-wrapper .image-overlay .delete-button #DeleteIcon{object-fit:contain;stroke-width:1.5;stroke:var(--delete-icon-color);width:80%;height:80%}.jb-image-input-web-component .image-wrapper .image-overlay .download-button{background-color:rgba(0,0,0,0);color:var(--download-button-color);border-radius:1rem;stroke:var(--download-button-color);width:2.5rem;height:2.5rem;display:flex;justify-content:center;align-items:center}.jb-image-input-web-component .image-wrapper .image-overlay .download-button:hover{background-color:var(--download-button--bg-color-hover);stroke:var(--download-button-color-hover)}.jb-image-input-web-component .image-wrapper .image-overlay .download-button #DownloadIcon{object-fit:contain;stroke-width:1.5;width:80%;height:80%}.jb-image-input-web-component .image-wrapper .image-overlay .reselect-button{background-color:rgba(0,0,0,0);border-radius:1rem;padding:.25rem .5rem;color:var(--reselect-button-color)}.jb-image-input-web-component .error-overlay{display:none;transition:all .3s 0s ease;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--error-overlay-bg-color);backdrop-filter:blur(8px);z-index:1;overflow:hidden;border-radius:var(--border-radius);justify-content:center;align-items:center}.jb-image-input-web-component .error-overlay .error-content{display:flex;justify-content:center;align-items:center;gap:1rem}.jb-image-input-web-component .error-overlay .error-content .error-icon{fill:var(--error-overlay-icon-color);width:4rem;height:4rem}.jb-image-input-web-component .error-overlay .error-content .error-message{color:var(--error-overlay-color);outline:var(--error-overlay-outline);font-size:1.3rem}</style>\n<div class="jb-image-input-web-component">\n  <div class="placeholder-wrapper">\n    <slot name="placeholder">\n      <div class="default-placeholder">\n        <div class="icon-wrapper">\n          <svg viewBox="0 0 59.19 47.06">\n            <g id="Layer_2" data-name="Layer 2">\n              <g id="Layer_1-2" data-name="Layer 1">\n                <g>\n                  <path class="cls-1" d="M27.45,14.85A5.65,5.65,0,1,0,21.8,20.5,5.66,5.66,0,0,0,27.45,14.85ZM21.8,17.5a2.65,2.65,0,1,1,2.65-2.65A2.65,2.65,0,0,1,21.8,17.5Z"/>\n                  <path class="cls-2" d="M58.7,31.38c.46-5.51.87-11.91-.15-18.18-.75-4.61-2.74-7.85-5.92-9.62C48.77,1.43,44.45,1,40.26.6L39.43.52a97.08,97.08,0,0,0-25.09.65A30.45,30.45,0,0,0,8.68,2.51,12.08,12.08,0,0,0,3.27,6.08C1.16,8.63.7,11.94.45,14.83A88.28,88.28,0,0,0,0,25.12c0,1.38.09,3,.23,4.59.26,3.1.84,7.08,3,10.38,2.87,4.4,7.65,5.44,11,5.83a130.41,130.41,0,0,0,14.84,1.14h.32a101.76,101.76,0,0,0,14.85-1.22C48.06,45.28,52,44.43,54.74,42a10.24,10.24,0,0,0,2.86-4.45,1.43,1.43,0,0,0,.08-.24A26.47,26.47,0,0,0,58.7,31.38ZM43.8,42.87a102.62,102.62,0,0,1-14.72,1.19,128.34,128.34,0,0,1-14.5-1.12c-3.91-.46-6.49-1.6-8.2-3.65l8.08-8.08a2.62,2.62,0,0,1,3.57,0c.68.72,6.72,7.06,7.72,8a1.5,1.5,0,1,0,2-2.23C27,36.22,22,31,20.18,29.09a5.54,5.54,0,0,0-7.83,0L4.8,36.63a23.31,23.31,0,0,1-1.56-7.18C3.11,27.93,3.06,26.37,3,25a85.56,85.56,0,0,1,.41-9.94C3.66,12.54,4,9.88,5.58,8A9.2,9.2,0,0,1,9.7,5.33h0A27.68,27.68,0,0,1,14.8,4.14,95.81,95.81,0,0,1,29.42,3a93.76,93.76,0,0,1,9.7.51l.85.08c3.88.38,7.88.77,11.2,2.62C53.51,7.51,55,10,55.59,13.68c1,5.93.57,12.11.12,17.44-.08.95-.18,1.88-.32,2.78L40.93,19.42A5.5,5.5,0,0,0,37,17.79h0a5.5,5.5,0,0,0-3.92,1.62l-8.88,8.88a1.5,1.5,0,0,0,2.12,2.12l8.88-8.88a2.53,2.53,0,0,1,1.8-.74h0a2.52,2.52,0,0,1,1.8.75L54.49,37.25a7,7,0,0,1-1.74,2.49C50.48,41.76,46.94,42.41,43.8,42.87Z"/>\n                </g>\n              </g>\n            </g>\n          </svg>\n        </div>\n        <div class="placeholder-title">انتخاب تصویر</div>\n        <div class="message-box" part="message"></div>\n      </div>\n      \n    </slot>\n\n  </div>\n  <div class="upload-loading-wrapper">\n    <span>در حال آپلود</span>\n  </div>\n  <div class="download-loading-wrapper">\n    <span>در حال آماده سازی</span>\n  </div>\n  <div class="image-wrapper">\n    <img src="">\n    <div class="image-overlay">\n      <div class="reselect-button">انتخاب مجدد تصویر</div>\n      <div class="download-button">\n        <svg id="DownloadIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path id="S1" d="M15.0382 12.5084L12.1222 15.4364L9.20621 12.5084" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n          <path id="S3" d="M12.1222 15.4361L12.1222 3.39508" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n          <path id="S2" d="M16.7549 8.12799H17.6879C19.7229 8.12799 21.3719 9.77699 21.3719 11.813V16.697C21.3719 18.727 19.7269 20.372 17.6969 20.372L6.55695 20.372C4.52195 20.372 2.87195 18.722 2.87195 16.687V11.802C2.87195 9.77299 4.51795 8.12799 6.54695 8.12799L7.48895 8.12799" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n      </div>\n      <div class="delete-button">\n        <svg id="DeleteIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path id="BinBody" d="M19.325 9.4682C19.325 9.4682 18.782 16.2032 18.467 19.0402C18.317 20.3952 17.48 21.1892 16.109 21.2142C13.5 21.2612 10.888 21.2642 8.28003 21.2092C6.96103 21.1822 6.13803 20.3782 5.99103 19.0472C5.67403 16.1852 5.13403 9.4682 5.13403 9.4682" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n            <path id="BinLine" d="M20.7082 6.23969H3.75024" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n            <path id="BinHead" d="M17.4406 6.23967C16.6556 6.23967 15.9796 5.68467 15.8256 4.91567L15.5826 3.69967C15.4326 3.13867 14.9246 2.75067 14.3456 2.75067H10.1126C9.53358 2.75067 9.02558 3.13867 8.87558 3.69967L8.63258 4.91567C8.47858 5.68467 7.80258 6.23967 7.01758 6.23967" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n      </div>\n    </div>\n  </div>\n  <div class="error-overlay">\n    \x3c!-- this container used to show flashed error and disappear after --\x3e\n     <div class="error-content">\n          <svg class="error-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M12 14.75C11.59 14.75 11.25 14.41 11.25 14V9C11.25 8.59 11.59 8.25 12 8.25C12.41 8.25 12.75 8.59 12.75 9V14C12.75 14.41 12.41 14.75 12 14.75Z"/>\n            <path d="M12 18C11.94 18 11.87 17.99 11.8 17.98C11.74 17.97 11.68 17.95 11.62 17.92C11.56 17.9 11.5 17.87 11.44 17.83C11.39 17.79 11.34 17.75 11.29 17.71C11.11 17.52 11 17.26 11 17C11 16.74 11.11 16.48 11.29 16.29C11.34 16.25 11.39 16.21 11.44 16.17C11.5 16.13 11.56 16.1 11.62 16.08C11.68 16.05 11.74 16.03 11.8 16.02C11.93 15.99 12.07 15.99 12.19 16.02C12.26 16.03 12.32 16.05 12.38 16.08C12.44 16.1 12.5 16.13 12.56 16.17C12.61 16.21 12.66 16.25 12.71 16.29C12.89 16.48 13 16.74 13 17C13 17.26 12.89 17.52 12.71 17.71C12.66 17.75 12.61 17.79 12.56 17.83C12.5 17.87 12.44 17.9 12.38 17.92C12.32 17.95 12.26 17.97 12.19 17.98C12.13 17.99 12.06 18 12 18Z"/>\n            <path d="M18.06 22.16H5.94001C3.99001 22.16 2.50001 21.45 1.74001 20.17C0.990006 18.89 1.09001 17.24 2.04001 15.53L8.10001 4.63C9.10001 2.83 10.48 1.84 12 1.84C13.52 1.84 14.9 2.83 15.9 4.63L21.96 15.54C22.91 17.25 23.02 18.89 22.26 20.18C21.5 21.45 20.01 22.16 18.06 22.16ZM12 3.34C11.06 3.34 10.14 4.06 9.41001 5.36L3.36001 16.27C2.68001 17.49 2.57001 18.61 3.04001 19.42C3.51001 20.23 4.55001 20.67 5.95001 20.67H18.07C19.47 20.67 20.5 20.23 20.98 19.42C21.46 18.61 21.34 17.5 20.66 16.27L14.59 5.36C13.86 4.06 12.94 3.34 12 3.34Z"/>\n            </svg>\n            <span class="error-message"></span>            \n     </div>\n  </div>\n</div>',e.appendChild(a.content.cloneNode(!0)),this.#n={webComponent:e.querySelector(".jb-image-input-web-component"),placeHolderWrapper:e.querySelector(".placeholder-wrapper"),placeHolderTitle:e.querySelector(".placeholder-title"),placeHolderMessageBox:e.querySelector(".message-box"),image:e.querySelector(".image-wrapper img"),overlay:{container:e.querySelector(".image-overlay"),deleteButton:e.querySelector(".image-overlay .delete-button"),downloadButton:e.querySelector(".image-overlay .download-button")},errorOverlay:{container:e.querySelector(".error-overlay"),message:e.querySelector(".error-overlay .error-message")}}}#o=!1;config={uploadUrl:"",downloadUrl:""};bridge={uploader:function(e){return new Promise((t=>{t(e)}))},downloader:function(e){return new Promise(((a,i)=>{"string"==typeof e&&fetch(e).then((e=>e.blob())).then((e=>{const t=new window.FileReader;t.readAsDataURL(e),t.onload=function(){const e=t.result;a(e)}})).catch(i),e instanceof File&&t.ExtractBase64ImageFromFile(e).then((e=>{a(e)}))}))}};#w(){this.acceptTypes="image/jpeg,image/jpg,image/png,image/svg+xml",this.#f("empty"),this.#j()}#y(){this.#n.placeHolderWrapper.addEventListener("click",this.openImageSelector.bind(this)),this.#n.image.addEventListener("click",this.openImageSelector.bind(this)),this.#n.overlay.container.addEventListener("click",this.openImageSelector.bind(this)),this.#n.overlay.deleteButton.addEventListener("click",this.#x.bind(this)),this.#n.overlay.downloadButton.addEventListener("click",this.#C.bind(this))}#j(){this.#r=document.createElement("input"),this.#r.type="file",this.#r.accept=this.acceptTypes,this.#r.addEventListener("change",(e=>this.#k(e)))}openImageSelector(){this.#r.click()}static get observedAttributes(){return["required","label","multiple","message"]}attributeChangedCallback(e,t,a){this.#V(e,a)}#V(e,t){switch(e){case"required":this.required=""===t||"true"==t;break;case"label":this.#n.placeHolderTitle&&(this.#n.placeHolderTitle.innerHTML=t);break;case"multiple":this.multiple="true"===t;break;case"message":this.#n.placeHolderMessageBox.innerHTML=t}}#S(e){const t=new CustomEvent("imageSelected",{detail:{files:e}});this.dispatchEvent(t)}#k(e){const t=e.target.files;if(t&&t?.length>0){this.#S(t);const e=t[0];this.#r.value=null,this.selectImageByFile(e)}}async selectImageByFile(e){const t=await this.validation.checkValidity({showError:!0,value:{file:e,value:null}});!!this.maxFileSize&&e.size>this.maxFileSize&&this.#E(e),t.isAllValid&&(this.#I(e),this.#F(e))}#I(e){this.#l=e,this.#L()}#E(e){const t=new CustomEvent("maxSizeExceed",{detail:{file:e},cancelable:!1});this.dispatchEvent(t)}static ExtractBase64ImageFromFile(e){return new Promise(((t,a)=>{const i=new FileReader;i.onload=e=>{const i=e.target?.result;i?t(i):a(e)},i.readAsDataURL(e)}))}#F(e){this.#f("uploading"),this.bridge.uploader(e,this.config,this.onProgressImageUpload.bind(this)).then((e=>this.#M(e))).catch((()=>this.#A()))}#M(e){const t=this.value;this.#f("uploaded"),this.value=e,this.#L().defaultPrevented&&(this.value=t)}#L(){const e=new Event("change",{bubbles:!0,composed:!0,cancelable:!1});return this.dispatchEvent(e),e}#A(){this.value?this.#f("downloaded"):this.#f("empty"),this.#r.value=""}onProgressImageUpload(e){this.#d=e}#B(e){this.#f("downloaded"),this.imageBase64Value=e,this.#n.image.setAttribute("src",e)}#f(e){this.#n.webComponent.setAttribute("status",e),this.#i=e}showValidationError(e){const t="string"==typeof e?e:e.message;this.#n.webComponent.classList.add("--has-error"),this.#e?this.#N(t):(this.#n.placeHolderMessageBox.innerHTML=t,this.#n.placeHolderMessageBox.classList.add("error"))}clearValidationError(){this.#n.webComponent.classList.remove("--has-error"),this.#n.placeHolderMessageBox.innerHTML=this.getAttribute("message")||"",this.#n.placeHolderMessageBox.classList.remove("error")}#N(e){this.#n.errorOverlay.message.innerHTML=e,this.#n.errorOverlay.container.style.display="flex",setTimeout((()=>{this.#n.errorOverlay.message.innerHTML="",this.#n.errorOverlay.container.style.display="none"}),2e3)}#g(){const e=[];if(this.required){const t="تصویر حتما باید انتخاب شود";e.push({validator:({file:e,value:t})=>null!==e||null!=t,message:t,stateType:"valueMissing"})}return this.#c&&e.push({validator:({file:e})=>null==e||e.size<=this.#c,message:"حجم فایل بیشتر از حد مجاز است",stateType:"rangeOverflow"}),e}checkValidity(){const e=this.#m.checkValiditySync({showError:!1});if(!e.isAllValid){const e=new CustomEvent("invalid");this.dispatchEvent(e)}return e.isAllValid}reportValidity(){const e=this.#m.checkValiditySync({showError:!0});if(!e.isAllValid){const e=new CustomEvent("invalid");this.dispatchEvent(e)}return e.isAllValid}#b(e){if(e.isAllValid)this.#u.setValidity({},"");else{const t={};let a="";e.validationList.forEach((e=>{e.isValid||(e.validation.stateType&&(t[e.validation.stateType]=!0),""==a&&(a=e.message))})),this.#u.setValidity(t,a)}}get validationMessage(){return this.#u.validationMessage}#x(e){e.stopPropagation(),this.#t(null),this.#L()}#C(e){e.stopPropagation();const t=this.#n.image.getAttribute("src"),a=t.match(/[^:/]\w+(?=;|,)/)[0],i=document.createElement("a");i.href=t,i.download="Image."+a,i.click()}#t(e){this.#e=e,null!=e?e instanceof File?(this.#l=e,t.ExtractBase64ImageFromFile(e).then(this.#B.bind(this))):this.bridge.downloader(e,this.config).then(this.#B.bind(this)):(this.#l=null,this.#f("empty"))}};!customElements.get("jb-image-input")&&window.customElements.define("jb-image-input",b);var jb_core_react=__webpack_require__("../../web-component/jb-core/react/index.js");let JBImageInput_l=react.forwardRef(((l,n)=>{let u=(0,react.useRef)(null),[m,p]=(0,react.useState)(0);return(0,react.useImperativeHandle)(n,(()=>u?u.current:{}),[u]),(0,react.useEffect)((()=>{p(m+1)}),[u.current]),(0,react.useEffect)((()=>{l.config&&u.current&&(u.current.config=l.config)}),[l.config]),(0,react.useEffect)((()=>{l.bridge&&u.current&&(u.current.bridge=l.bridge)}),[l.bridge]),(0,react.useEffect)((()=>{l.multiple?u.current?.setAttribute("multiple","true"):u.current?.removeAttribute("multiple")}),[l.multiple]),(0,react.useEffect)((()=>{void 0!==l.value&&u.current&&(u.current.value=l.value)}),[l.value]),(0,react.useEffect)((()=>{l.file&&u.current?.selectImageByFile(l.file)}),[l.file]),(0,react.useEffect)((()=>{l.acceptTypes&&u.current&&(u.current.acceptTypes=l.acceptTypes)}),[l.acceptTypes]),(0,react.useEffect)((()=>{void 0!==l.maxFileSize&&u.current&&(u.current.maxFileSize=l.maxFileSize)}),[l.maxFileSize]),(0,jb_core_react._q)(u,"load",l.onLoad,!0),(0,jb_core_react._q)(u,"init",l.onInit,!0),(0,jb_core_react._q)(u,"change",l.onChange),(0,jb_core_react._q)(u,"imageSelected",l.onImageSelected),(0,jb_core_react._q)(u,"maxSizeExceed",l.onMaxSizeExceed),react.createElement("jb-image-input",{ref:u,class:l.className||"",label:l.label,"upload-type":l.uploadType||"AUTO",required:l.required,name:l.name,message:l.message||""},l.children)}));JBImageInput_l.displayName="JBImageInput"}}]);