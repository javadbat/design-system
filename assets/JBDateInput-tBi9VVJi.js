import{r as u,R as G}from"./index-0yr9KlQE.js";import"./jb-date-input-CesgSBEp.js";import{i as H}from"./index-C3i7CD6V.js";var k;function c(e,m,t,a=!1){let n=u.useCallback(r=>{e.current&&typeof t=="function"&&t(r)},[e,t]);u.useEffect(()=>{let r=e.current;return r&&r.addEventListener(m,n,{passive:a,capture:!1}),function(){r&&r.removeEventListener(m,n,{passive:a,capture:!1})}},[e,m,t,a])}function B(e){return e.substring(5,7)}function P(e){return e.substring(0,4)}function U(e){let[m,t]=u.useState("    /  /  "),a=u.useRef(null);u.useEffect(()=>{a.current&&setTimeout(()=>{e.ref.current.setSelectionRange(a.current.selectionStart,a.current.selectionEnd),a.current=null},0)},[m,a.current]);let n=()=>{if(a.current===null){let r=(function(i){let s=i.selectionStart;if(s){let w=P(i.inputValue).trim().length;if(w<s&&s<=4)return w;let L=B(i.inputValue).trim().length;if(L+5<s&&s>4&&s<=7)return L+5;let v=i.inputValue.substring(8,10).trim().length;if(v+8<s&&s>7&&s<=10)return v+8}return null})({inputValue:m,selectionStart:e.ref.current.selectionStart});r!=null&&r!==e.ref.current.selectionStart&&e.ref.current.setSelectionRange(r,r)}};return c(e.ref,"beforeinput",function(r){a.current=(function(i){let{dateInputType:s,selection:w,event:{data:L,inputType:v}}=i,T=w.start,N=T,I=i.value;return L&&H(i.event.data||"").replace(/[^\u06F0-\u06F90-9/]/g,"").split("").forEach((f,g)=>{var d,o;let p,l=T+g;if(!/[\u06F0-\u06F90-9/]/g.test(f))return;l!=4&&l!=7||(f=="/"&&C(l+1),l++);let h=!1;if(f=="/")return;let A=Number(f);l==5&&A>1&&(R("0",l),l++);let F=(d=I,p=!1,(o=l)==5&&A==1&&d[6]>"2"&&(p=!0),o==6&&A>2&&d[5]=="1"&&(p=!0),o==6&&A==0&&d[5]=="0"&&(p=!0),o==5&&A==0&&d[4]=="0"&&(p=!0),{isIgnoreChar:p,caretPos:o}),x=(function(J,D,y,b,S){let E=!1;if(y==8&&D>3&&(S("0",y),y++),y==9&&D>1&&b[8]=="3"&&(E=!0),y==9&&D==0&&b[8]=="0"&&(E=!0),y==8&&D==0&&b[9]=="0"&&(E=!0),!E){let V=B(b),M=Number(V);if(y==9&&b[8]=="3"&&D>0&&M>6&&(E=!0),y==8&&D==3){if(M==12){let j=Number(P(b));!Number.isNaN(j)&&[1,5,9,13,17,22,26,30].includes(j%33)||(E=!0)}b[9]>"0"&&(V.length==2&&parseInt(b)>6&&S("0",9),V.length==2&&M<7&&b[9]>"1"&&S("1",9))}}return{isIgnoreChar:E,caretPos:y}})(s,A,l=F.caretPos,I,R);l=x.caretPos,(h=h||x.isIgnoreChar||F.isIgnoreChar)||(R(f,l),C(l+1))}),v!="deleteContentBackward"&&v!="deleteContentForward"&&v!="delete"&&v!="deleteByCut"&&v!="deleteByDrag"||(function(f,g,d,o,p){let l=0;f=="deleteContentBackward"&&(l=g!==d?0:-1);for(let h=g;h<=d;h++)o(" ",h+l);p(g+l)})(v,w.start,w.end,R,C),{value:I,selectionStart:N,selectionEnd:N};function R(f,g){I=(function(d,o,p,l){if(o!=4&&o!=7||(d="/"),o>9||o<0)return p;let h=p.split("");return h[o]=d,h.join("")})(f,g,I)}function C(f){N=f}})({dateInputType:e.dateInputType,selection:{start:e.ref.current.selectionStart,end:e.ref.current.selectionEnd},value:m,event:{inputType:r.inputType,data:r.data}}),r.preventDefault(),t(a.current.value),e.ref.current.setSelectionRange(a.current.selectionStart,a.current.selectionEnd)}),{value:m,setValue:t,onFocus:()=>{n()},onClick:()=>{n()},onChange:()=>{}}}(k={}).jalali="JALALI",k.gregorian="GREGORIAN";let q=u.forwardRef((e,m)=>{let t=u.useRef(null);u.useImperativeHandle(m,()=>t?t.current:{},[t]);let a=u.useRef([]);return u.useEffect(()=>{var n,r;e.format&&(e.format!==((n=t.current)==null?void 0:n.valueFormat)&&((r=t.current)==null||r.setAttribute("format",e.format)),a.current.length>0&&(a.current.forEach(i=>{i()}),a.current=[]))},[e.format]),u.useEffect(()=>{var n,r;e.max&&(e.format&&e.format!==((n=t.current)==null?void 0:n.valueFormat)?a.current.push(()=>{var i;e.max&&((i=t.current)==null||i.setMaxDate(e.max))}):(r=t.current)==null||r.setMaxDate(e.max))},[e.max]),u.useEffect(()=>{var n,r;e.name?(n=t==null?void 0:t.current)==null||n.setAttribute("name",e.name||""):(r=t==null?void 0:t.current)==null||r.removeAttribute("name")},[e.name]),u.useEffect(()=>{var n,r;e.min&&(e.format&&e.format!==((n=t.current)==null?void 0:n.valueFormat)?a.current.push(()=>{var i;e.min&&((i=t.current)==null||i.setMinDate(e.min))}):(r=t.current)==null||r.setMinDate(e.min))},[e.min]),u.useEffect(()=>{t.current&&e.value&&(t.current.value=e.value)},[e.value]),u.useEffect(()=>{t.current&&t.current.setAttribute("message",e.message||"")},[e.message]),u.useEffect(()=>{t.current&&Array.isArray(e.jalaliMonthList)&&t.current.setMonthList("JALALI",e.jalaliMonthList)},[e.jalaliMonthList]),u.useEffect(()=>{t.current&&Array.isArray(e.gregorianMonthList)&&t.current.setMonthList("GREGORIAN",e.gregorianMonthList)},[e.gregorianMonthList]),u.useEffect(()=>{t.current&&e.placeholder!==void 0&&(t.current.placeholder=e.placeholder)},[e.placeholder]),u.useEffect(()=>{t.current&&e.overflowHandler!==void 0&&(t.current.elements.popover.overflowHandler=e.overflowHandler)},[e.overflowHandler]),u.useEffect(()=>{t.current&&e.overflowRef!==void 0&&(t.current.elements.popover.overflowDom=e.overflowRef.current)},[e.overflowRef]),u.useEffect(()=>{t.current&&Array.isArray(e.validationList)&&(t.current.validation.list=e.validationList)},[e.validationList]),u.useEffect(()=>{t.current&&e.direction&&t.current.setAttribute("direction",e.direction)},[e.direction]),u.useEffect(()=>{t.current&&(e.required?t.current.required=!0:t.current.required=!1)},[e.required,t.current]),u.useEffect(()=>{var n;typeof e.calendarDefaultDateView=="object"&&e.calendarDefaultDateView.year&&e.calendarDefaultDateView.month&&((n=t.current)==null||n.setCalendarDefaultDateView(e.calendarDefaultDateView.year,e.calendarDefaultDateView.month,e.calendarDefaultDateView.dateType))},[e.calendarDefaultDateView]),u.useEffect(()=>{var n,r;e.showPersianNumber?(n=t.current)==null||n.setAttribute("show-persian-number","true"):(r=t.current)==null||r.removeAttribute("show-persian-number")},[e.showPersianNumber]),u.useEffect(()=>{var n;typeof e.disabled=="boolean"&&((n=t==null?void 0:t.current)==null||n.setAttribute("disabled",`${e.disabled}`))},[e.disabled]),u.useEffect(()=>{var n,r;e.error?(n=t==null?void 0:t.current)==null||n.setAttribute("error",e.error):(r=t==null?void 0:t.current)==null||r.removeAttribute("error")},[e.error]),c(t,"load",e.onLoad,!0),c(t,"init",e.onInit,!0),c(t,"invalid",e.onInvalid,!0),c(t,"change",e.onChange,!0),c(t,"beforeinput",e.onBeforeInput,!1),c(t,"input",e.onInput,!0),c(t,"keyup",e.onKeyUp,!0),c(t,"keydown",e.onKeyDown,!1),c(t,"keypress",e.onKeyPress,!0),c(t,"select",e.onSelect,!0),c(t,"focus",e.onFocus,!0),c(t,"blur",e.onBlur,!0),G.createElement("jb-date-input",{style:e.style,class:e.className?e.className:"",label:e.label,"value-type":e.valueType?e.valueType:"GREGORIAN",ref:t,"input-type":e.inputType?e.inputType:"JALALI"},e.children)});q.displayName="JBDateInput";export{q as m,U as p};
