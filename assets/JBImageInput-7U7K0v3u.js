var ve=Object.defineProperty;var X=t=>{throw TypeError(t)};var we=(t,r,e)=>r in t?ve(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var y=(t,r,e)=>we(t,typeof r!="symbol"?r+"":r,e),J=(t,r,e)=>r.has(t)||X("Cannot "+e);var i=(t,r,e)=>(J(t,r,"read from private field"),e?e.call(t):r.get(t)),h=(t,r,e)=>r.has(t)?X("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(t):r.set(t,e),u=(t,r,e,a)=>(J(t,r,"write to private field"),a?a.call(t,e):r.set(t,e),e),o=(t,r,e)=>(J(t,r,"access private method"),e);import{R as Y,r as g}from"./index-D4lIrffr.js";import{e as ye}from"./jb-validation-BFHHOeHY.js";import{r as B}from"./index-B65NTg4l.js";var p=class{constructor(t,r){y(this,"lightness");y(this,"chroma");y(this,"hue");y(this,"variableName");this.variableName=r,this.lightness=t.lightness,this.chroma=t.chroma,this.hue=t.hue}get value(){return`oklch(${this.lightness} ${this.chroma} ${this.hue})`}};function b(t){return new p({lightness:6*(3+1.3*t)*.01,chroma:.001*(14+.09*t),hue:258.36},`--jb-neutral-${t}`)}function F(t){return new p({lightness:t.lightness+.07,chroma:t.chroma+.07,hue:t.hue},`${t.variableName}-hover`)}function T(t){return new p({lightness:t.lightness-.1,chroma:t.chroma-.05,hue:t.hue},`${t.variableName}-pressed`)}function H(t){const r=Math.min(t.lightness+.12*(1-t.lightness),.985),e=t.chroma*(1-.15*(r-t.lightness));return new p({lightness:r,chroma:Number(e.toFixed(3)),hue:t.hue},`${t.variableName}-l`)}function I(t){const r=Math.max(t.lightness-.12*t.lightness,.02),e=t.chroma*(1-.15*(r-t.lightness));return new p({lightness:r,chroma:e,hue:t.hue},`${t.variableName}-d`)}function z(t){const r=Math.min(t.lightness+.65*(1-t.lightness),.93),e=.55*t.chroma*(1-.08*(r-t.lightness)),a=t.hue>=70&&t.hue<=162?5:-3,s=t.hue+a;return new p({lightness:r,chroma:Number(e.toFixed(3)),hue:s},`${t.variableName}-subtle`)}function q(t){const r=Math.max(t.lightness-.35,.22),e=Math.min(1.6*t.chroma,.28);return new p({lightness:Number(r.toFixed(3)),chroma:Number(e.toFixed(3)),hue:t.hue},`${t.variableName}-contrast`)}const k=new p({lightness:.6,chroma:.26,hue:256},"--jb-primary"),V=new p({lightness:.6,chroma:.26,hue:286},"--jb-secondary"),E=new p({lightness:.75,chroma:.18,hue:70},"--jb-yellow"),L=new p({lightness:.68,chroma:.1484,hue:162.1},"--jb-green"),S=new p({lightness:.6,chroma:.22,hue:23.21},"--jb-red"),_={single:{black:new p({lightness:.14,chroma:0,hue:0},"--jb-black"),white:new p({lightness:1,chroma:0,hue:0},"--jb-white"),highlight:new p({lightness:.93,chroma:.2302,hue:125.18},"--jb-highlight")},neutral:[b(0),b(1),b(2),b(3),b(4),b(5),b(6),b(7),b(8),b(9),b(10)],primary:{main:k,hover:F(k),pressed:T(k),light:H(k),dark:I(k),subtle:z(k),contrast:q(k)},secondary:{main:V,hover:F(V),pressed:T(V),light:H(V),dark:I(V),subtle:z(V),contrast:q(V)},yellow:{main:E,hover:F(E),pressed:T(E),light:H(E),dark:I(E),subtle:z(E),contrast:q(E)},green:{main:L,hover:F(L),pressed:T(L),light:H(L),dark:I(L),subtle:z(L),contrast:q(L)},red:{main:S,hover:F(S),pressed:T(S),light:H(S),dark:I(S),subtle:z(S),contrast:q(S)}};function d(t){try{const{value:r,...e}=t;window.CSS.registerProperty({...e}),function(a,s){try{s&&(document.documentElement.style.getPropertyValue(a)||document.documentElement.style.setProperty(a,s))}catch{}}(t.name,r)}catch{}}function fe(){var t;d({name:"--jb-radius",inherits:!0,value:"1rem",initialValue:"16px",syntax:"<length-percentage>"}),d({name:"--jb-radius-xs",inherits:!0,value:"0.5rem",initialValue:"8px",syntax:"<length-percentage>"}),d({name:"--jb-radius-sm",inherits:!0,value:"0.75rem",initialValue:"12px",syntax:"<length-percentage>"}),d({name:"--jb-radius-lg",inherits:!0,value:"1.25rem",initialValue:"20px",syntax:"<length-percentage>"}),d({name:"--jb-radius-xl",inherits:!0,value:"1.5rem",initialValue:"24px",syntax:"<length-percentage>"}),function(r){d({name:r.primary.main.variableName,syntax:"<color>",inherits:!0,initialValue:r.primary.main.value}),d({name:r.secondary.main.variableName,syntax:"<color>",inherits:!0,initialValue:r.secondary.main.value}),d({name:"--jb-neutral",syntax:"<color>",inherits:!0,initialValue:r.neutral[0].value}),d({name:r.single.black.variableName,syntax:"<color>",inherits:!0,initialValue:r.single.black.value}),d({name:r.single.white.variableName,syntax:"<color>",inherits:!0,initialValue:r.single.white.value}),d({name:r.single.highlight.variableName,syntax:"<color>",inherits:!0,initialValue:r.single.highlight.value}),d({name:r.yellow.main.variableName,syntax:"<color>",inherits:!0,initialValue:r.yellow.main.value}),d({name:r.green.main.variableName,syntax:"<color>",inherits:!0,initialValue:r.green.main.value}),d({name:r.red.main.variableName,syntax:"<color>",inherits:!0,initialValue:r.red.main.value}),d({name:"--jb-neutral",syntax:"<color>",inherits:!0,initialValue:r.neutral[0].value});for(let e=1;e<=10;e++)d({name:r.neutral[e].variableName,syntax:"<color>",inherits:!0,initialValue:r.neutral[e].value})}(_),d({name:"--jb-text-primary",syntax:"<color>",inherits:!0,initialValue:(t=_).single.black.value}),d({name:"--jb-text-secondary",syntax:"<color>",inherits:!0,initialValue:t.neutral[7].value}),d({name:"--jb-text-contrast",syntax:"<color>",inherits:!0,initialValue:t.single.white.value})}var $,P,m,c,D,x,C,v,W,R,Z,f,M,n,ee,N,te,ae,re,ie,ne,oe,le,se,ce,de,U,ue,G,j,he,pe,me,ge,be,K,A,je=(A=class extends HTMLElement{constructor(){super();h(this,n);h(this,$,!1);h(this,P,null);h(this,m);h(this,c);h(this,D,"image/jpeg,image/jpg,image/png,image/svg+xml");h(this,x,null);h(this,C,null);h(this,v,null);h(this,W,null);y(this,"imageBase64Value",null);h(this,R,!1);h(this,Z,!1);h(this,f);h(this,M,new ye({showValidationError:this.showValidationError.bind(this),clearValidationError:this.clearValidationError.bind(this),getValue:()=>({file:i(this,v),value:i(this,C)}),getValidations:o(this,n,pe).bind(this),setValidationResult:o(this,n,me).bind(this),getValueString:()=>this.fileName}));y(this,"initialValue",null);h(this,N,!1);y(this,"config",{uploadUrl:"",downloadUrl:""});y(this,"bridge",{uploader:function(e){return new Promise(a=>{a(e)})},downloader:function(e){return new Promise((a,s)=>{typeof e=="string"&&fetch(e).then(l=>l.blob()).then(l=>{const w=new window.FileReader;w.readAsDataURL(l),w.onload=function(){const O=w.result;a(O)}}).catch(s),e instanceof File&&A.ExtractBase64ImageFromFile(e).then(l=>{a(l)})})}});typeof this.attachInternals=="function"&&u(this,f,this.attachInternals()),o(this,n,ee).call(this),o(this,n,te).call(this),o(this,n,ae).call(this)}static get formAssociated(){return!0}get value(){return i(this,C)}set value(e){o(this,n,K).call(this,e)}get isAutoValidationDisabled(){return i(this,$)}set isAutoValidationDisabled(e){u(this,$,e)}get selectedImageType(){return i(this,v).type}get status(){return i(this,P)}get multiple(){return i(this,N)}set multiple(e){u(this,N,e),i(this,N)?i(this,m).setAttribute("multiple","multiple"):i(this,m).removeAttribute("multiple")}get acceptTypes(){return i(this,D)}set acceptTypes(e){u(this,D,e),i(this,m)&&(i(this,m).accept=e)}get file(){return i(this,v)}get maxFileSize(){return i(this,x)}set maxFileSize(e){e==null?u(this,x,null):isNaN(e)||typeof e!="number"||u(this,x,e)}get disabled(){return i(this,R)}set disabled(e){var a,s;u(this,R,e),e?(a=i(this,f).states)==null||a.add("disabled"):(s=i(this,f).states)==null||s.delete("disabled")}set required(e){u(this,Z,e),i(this,M).checkValidity({showError:!1})}get required(){return i(this,Z)}get validation(){return i(this,M)}get name(){return this.getAttribute("name")||""}get isDirty(){return i(this,C)!==this.initialValue}get fileName(){return i(this,v).name}openImageSelector(){i(this,m).click()}static get observedAttributes(){return["required","label","multiple","message"]}attributeChangedCallback(e,a,s){o(this,n,ie).call(this,e,s)}async selectImageByFile(e){const a=await this.validation.checkValidity({showError:!0,value:{file:e,value:null}});this.maxFileSize&&e.size>this.maxFileSize&&o(this,n,se).call(this,e),a.isAllValid&&(o(this,n,le).call(this,e),o(this,n,ce).call(this,e))}static ExtractBase64ImageFromFile(e){return new Promise((a,s)=>{const l=new FileReader;l.onload=w=>{var Q;const O=(Q=w.target)==null?void 0:Q.result;O?a(O):s(w)},l.readAsDataURL(e)})}onProgressImageUpload(e){u(this,W,e)}showValidationError(e){const a=typeof e=="string"?e:e.message;i(this,c).webComponent.classList.add("--has-error"),i(this,C)?o(this,n,he).call(this,a):(i(this,c).placeHolderMessageBox.innerHTML=a,i(this,c).placeHolderMessageBox.classList.add("error"))}clearValidationError(){i(this,c).webComponent.classList.remove("--has-error"),i(this,c).placeHolderMessageBox.innerHTML=this.getAttribute("message")||"",i(this,c).placeHolderMessageBox.classList.remove("error")}checkValidity(){const e=i(this,M).checkValiditySync({showError:!1});if(!e.isAllValid){const a=new CustomEvent("invalid");this.dispatchEvent(a)}return e.isAllValid}reportValidity(){const e=i(this,M).checkValiditySync({showError:!0});if(!e.isAllValid){const a=new CustomEvent("invalid");this.dispatchEvent(a)}return e.isAllValid}get validationMessage(){return i(this,f).validationMessage}},$=new WeakMap,P=new WeakMap,m=new WeakMap,c=new WeakMap,D=new WeakMap,x=new WeakMap,C=new WeakMap,v=new WeakMap,W=new WeakMap,R=new WeakMap,Z=new WeakMap,f=new WeakMap,M=new WeakMap,n=new WeakSet,ee=function(){const e=this.attachShadow({mode:"open",delegatesFocus:!0});fe();const a=document.createElement("template");a.innerHTML=`<style>:host{--border-radius: var(--jb-image-input-border-radius, var(--jb-radius-xl));--button-border-radius: var(--jb-image-input-button-border-radius, var(--jb-radius));--bg-color:var(--jb-image-input-bg-color, var(--jb-neutral-10));--placeholder-neutral-color: var(--jb-image-input-placeholder-p-color, var(--jb-neutral));--placeholder-primary-color: var(--jb-image-input-placeholder-sec-color, var(--jb-primary));--placeholder-title-color:var(--jb-image-input-placeholder-title-color, var(--jb-neutral));--message-color:var(--jb-image-input-message-color, var(--jb-text-secondary));--message-error-color:var(--jb-image-input-message-error-color, var(--jb-red));--overlay-bg-color:oklch(from var(--jb-neutral) l c h / calc(alpha - 0.5));--delete-button-color:var(--jb-red);--delete-button-bg-color:var(--jb-white);--delete-icon-color:var(--jb-red);--download-button-color:var(--jb-white);--download-button--bg-color-hover:var(--jb-white);--download-button-color-hover:var(--jb-neutral);--reselect-button-color:var(--jb-white);--error-overlay-bg-color:oklch(from var(--jb-red) l c h / calc(alpha - 0.5));--error-overlay-color:var(--jb-white);--error-overlay-icon-color:var(--jb-white);--error-overlay-outline:var(--jb-black)}:host{width:var(--jb-image-input-width, 100%);height:var(--jb-image-input-height, 100%)}.jb-image-input-web-component{position:relative;background-color:var(--bg-color);width:100%;height:100%;border-radius:var(--border-radius);display:flex;justify-content:center;align-items:center;overflow:hidden;box-sizing:border-box}.jb-image-input-web-component[status=empty] .placeholder-wrapper{display:flex}.jb-image-input-web-component .placeholder-wrapper{width:100%;height:100%;display:none;cursor:pointer;background-color:var(--jb-image-input-placeholder-bg-color, transparent)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder{width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;gap:.25rem;padding:.5rem}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .icon-wrapper svg{width:64px;height:64px;fill:var(--placeholder-neutral-color)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .icon-wrapper svg .cls-1{fill:var(--placeholder-primary-color)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .placeholder-title{color:var(--placeholder-title-color);font-variation-settings:"wght" 600}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .message-box{font-size:var(--jb-image-input-message-font-size, 0.7rem);padding:2px 8px;color:var(--message-color);display:var(--jb-image-input-message-box-display, block)}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .message-box:empty{padding:0}.jb-image-input-web-component .placeholder-wrapper .default-placeholder .message-box.error{color:var(--message-error-color)}.jb-image-input-web-component[status=uploading] .upload-loading-wrapper{display:flex}.jb-image-input-web-component .upload-loading-wrapper{display:none}.jb-image-input-web-component[status=uploaded] .download-loading-wrapper{display:flex}.jb-image-input-web-component .download-loading-wrapper{display:none}.jb-image-input-web-component[status=downloaded] .image-wrapper{display:block}.jb-image-input-web-component[status=downloaded] .image-wrapper img{object-fit:contain;width:100%;height:100%}.jb-image-input-web-component .image-wrapper{position:relative;display:none;width:100%;height:100%;object-fit:contain}.jb-image-input-web-component .image-wrapper:hover .image-overlay{opacity:1}.jb-image-input-web-component .image-wrapper .image-overlay{cursor:pointer;opacity:0;transition:all .3s 0s ease;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--overlay-bg-color);backdrop-filter:blur(8px);z-index:1;overflow:hidden;border-radius:var(--border-radius);display:flex;justify-content:center;align-items:center;gap:1rem;flex-wrap:wrap}.jb-image-input-web-component .image-wrapper .image-overlay .delete-button{background-color:rgba(0,0,0,0);color:var(--delete-button-color);border-radius:var(--button-border-radius);width:2.5rem;height:2.5rem;display:flex;justify-content:center;align-items:center}.jb-image-input-web-component .image-wrapper .image-overlay .delete-button:hover{background-color:var(--delete-button-bg-color)}.jb-image-input-web-component .image-wrapper .image-overlay .delete-button #DeleteIcon{object-fit:contain;stroke-width:1.5;stroke:var(--delete-icon-color);width:80%;height:80%}.jb-image-input-web-component .image-wrapper .image-overlay .download-button{background-color:rgba(0,0,0,0);color:var(--download-button-color);border-radius:var(--button-border-radius);stroke:var(--download-button-color);width:2.5rem;height:2.5rem;display:flex;justify-content:center;align-items:center}.jb-image-input-web-component .image-wrapper .image-overlay .download-button:hover{background-color:var(--download-button--bg-color-hover);stroke:var(--download-button-color-hover)}.jb-image-input-web-component .image-wrapper .image-overlay .download-button #DownloadIcon{object-fit:contain;stroke-width:1.5;width:80%;height:80%}.jb-image-input-web-component .image-wrapper .image-overlay .reselect-button{background-color:rgba(0,0,0,0);border-radius:1rem;padding:.25rem .5rem;color:var(--reselect-button-color)}.jb-image-input-web-component .error-overlay{display:none;transition:all .3s 0s ease;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--error-overlay-bg-color);backdrop-filter:blur(8px);z-index:1;overflow:hidden;border-radius:var(--border-radius);justify-content:center;align-items:center}.jb-image-input-web-component .error-overlay .error-content{display:flex;justify-content:center;align-items:center;gap:1rem}.jb-image-input-web-component .error-overlay .error-content .error-icon{fill:var(--error-overlay-icon-color);width:4rem;height:4rem}.jb-image-input-web-component .error-overlay .error-content .error-message{color:var(--error-overlay-color);outline:var(--error-overlay-outline);font-size:1.3rem}</style>
<div class="jb-image-input-web-component">
  <div class="placeholder-wrapper">
    <slot name="placeholder">
      <div class="default-placeholder">
        <div class="icon-wrapper">
          <svg viewBox="0 0 59.19 47.06">
            <g id="Layer_2" data-name="Layer 2">
              <g id="Layer_1-2" data-name="Layer 1">
                <g>
                  <path class="cls-1" d="M27.45,14.85A5.65,5.65,0,1,0,21.8,20.5,5.66,5.66,0,0,0,27.45,14.85ZM21.8,17.5a2.65,2.65,0,1,1,2.65-2.65A2.65,2.65,0,0,1,21.8,17.5Z"/>
                  <path class="cls-2" d="M58.7,31.38c.46-5.51.87-11.91-.15-18.18-.75-4.61-2.74-7.85-5.92-9.62C48.77,1.43,44.45,1,40.26.6L39.43.52a97.08,97.08,0,0,0-25.09.65A30.45,30.45,0,0,0,8.68,2.51,12.08,12.08,0,0,0,3.27,6.08C1.16,8.63.7,11.94.45,14.83A88.28,88.28,0,0,0,0,25.12c0,1.38.09,3,.23,4.59.26,3.1.84,7.08,3,10.38,2.87,4.4,7.65,5.44,11,5.83a130.41,130.41,0,0,0,14.84,1.14h.32a101.76,101.76,0,0,0,14.85-1.22C48.06,45.28,52,44.43,54.74,42a10.24,10.24,0,0,0,2.86-4.45,1.43,1.43,0,0,0,.08-.24A26.47,26.47,0,0,0,58.7,31.38ZM43.8,42.87a102.62,102.62,0,0,1-14.72,1.19,128.34,128.34,0,0,1-14.5-1.12c-3.91-.46-6.49-1.6-8.2-3.65l8.08-8.08a2.62,2.62,0,0,1,3.57,0c.68.72,6.72,7.06,7.72,8a1.5,1.5,0,1,0,2-2.23C27,36.22,22,31,20.18,29.09a5.54,5.54,0,0,0-7.83,0L4.8,36.63a23.31,23.31,0,0,1-1.56-7.18C3.11,27.93,3.06,26.37,3,25a85.56,85.56,0,0,1,.41-9.94C3.66,12.54,4,9.88,5.58,8A9.2,9.2,0,0,1,9.7,5.33h0A27.68,27.68,0,0,1,14.8,4.14,95.81,95.81,0,0,1,29.42,3a93.76,93.76,0,0,1,9.7.51l.85.08c3.88.38,7.88.77,11.2,2.62C53.51,7.51,55,10,55.59,13.68c1,5.93.57,12.11.12,17.44-.08.95-.18,1.88-.32,2.78L40.93,19.42A5.5,5.5,0,0,0,37,17.79h0a5.5,5.5,0,0,0-3.92,1.62l-8.88,8.88a1.5,1.5,0,0,0,2.12,2.12l8.88-8.88a2.53,2.53,0,0,1,1.8-.74h0a2.52,2.52,0,0,1,1.8.75L54.49,37.25a7,7,0,0,1-1.74,2.49C50.48,41.76,46.94,42.41,43.8,42.87Z"/>
                </g>
              </g>
            </g>
          </svg>
        </div>
        <div class="placeholder-title">انتخاب تصویر</div>
        <div class="message-box" part="message"></div>
      </div>
      
    </slot>

  </div>
  <div class="upload-loading-wrapper">
    <span>در حال آپلود</span>
  </div>
  <div class="download-loading-wrapper">
    <span>در حال آماده سازی</span>
  </div>
  <div class="image-wrapper">
    <img src="">
    <div class="image-overlay">
      <div class="reselect-button">انتخاب مجدد تصویر</div>
      <div class="download-button">
        <svg id="DownloadIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path id="S1" d="M15.0382 12.5084L12.1222 15.4364L9.20621 12.5084" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path id="S3" d="M12.1222 15.4361L12.1222 3.39508" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path id="S2" d="M16.7549 8.12799H17.6879C19.7229 8.12799 21.3719 9.77699 21.3719 11.813V16.697C21.3719 18.727 19.7269 20.372 17.6969 20.372L6.55695 20.372C4.52195 20.372 2.87195 18.722 2.87195 16.687V11.802C2.87195 9.77299 4.51795 8.12799 6.54695 8.12799L7.48895 8.12799" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="delete-button">
        <svg id="DeleteIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path id="BinBody" d="M19.325 9.4682C19.325 9.4682 18.782 16.2032 18.467 19.0402C18.317 20.3952 17.48 21.1892 16.109 21.2142C13.5 21.2612 10.888 21.2642 8.28003 21.2092C6.96103 21.1822 6.13803 20.3782 5.99103 19.0472C5.67403 16.1852 5.13403 9.4682 5.13403 9.4682" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path id="BinLine" d="M20.7082 6.23969H3.75024" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path id="BinHead" d="M17.4406 6.23967C16.6556 6.23967 15.9796 5.68467 15.8256 4.91567L15.5826 3.69967C15.4326 3.13867 14.9246 2.75067 14.3456 2.75067H10.1126C9.53358 2.75067 9.02558 3.13867 8.87558 3.69967L8.63258 4.91567C8.47858 5.68467 7.80258 6.23967 7.01758 6.23967" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>
  </div>
  <div class="error-overlay">
    <!-- this container used to show flashed error and disappear after -->
     <div class="error-content">
          <svg class="error-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 14.75C11.59 14.75 11.25 14.41 11.25 14V9C11.25 8.59 11.59 8.25 12 8.25C12.41 8.25 12.75 8.59 12.75 9V14C12.75 14.41 12.41 14.75 12 14.75Z"/>
            <path d="M12 18C11.94 18 11.87 17.99 11.8 17.98C11.74 17.97 11.68 17.95 11.62 17.92C11.56 17.9 11.5 17.87 11.44 17.83C11.39 17.79 11.34 17.75 11.29 17.71C11.11 17.52 11 17.26 11 17C11 16.74 11.11 16.48 11.29 16.29C11.34 16.25 11.39 16.21 11.44 16.17C11.5 16.13 11.56 16.1 11.62 16.08C11.68 16.05 11.74 16.03 11.8 16.02C11.93 15.99 12.07 15.99 12.19 16.02C12.26 16.03 12.32 16.05 12.38 16.08C12.44 16.1 12.5 16.13 12.56 16.17C12.61 16.21 12.66 16.25 12.71 16.29C12.89 16.48 13 16.74 13 17C13 17.26 12.89 17.52 12.71 17.71C12.66 17.75 12.61 17.79 12.56 17.83C12.5 17.87 12.44 17.9 12.38 17.92C12.32 17.95 12.26 17.97 12.19 17.98C12.13 17.99 12.06 18 12 18Z"/>
            <path d="M18.06 22.16H5.94001C3.99001 22.16 2.50001 21.45 1.74001 20.17C0.990006 18.89 1.09001 17.24 2.04001 15.53L8.10001 4.63C9.10001 2.83 10.48 1.84 12 1.84C13.52 1.84 14.9 2.83 15.9 4.63L21.96 15.54C22.91 17.25 23.02 18.89 22.26 20.18C21.5 21.45 20.01 22.16 18.06 22.16ZM12 3.34C11.06 3.34 10.14 4.06 9.41001 5.36L3.36001 16.27C2.68001 17.49 2.57001 18.61 3.04001 19.42C3.51001 20.23 4.55001 20.67 5.95001 20.67H18.07C19.47 20.67 20.5 20.23 20.98 19.42C21.46 18.61 21.34 17.5 20.66 16.27L14.59 5.36C13.86 4.06 12.94 3.34 12 3.34Z"/>
            </svg>
            <span class="error-message"></span>            
     </div>
  </div>
</div>`,e.appendChild(a.content.cloneNode(!0)),u(this,c,{webComponent:e.querySelector(".jb-image-input-web-component"),placeHolderWrapper:e.querySelector(".placeholder-wrapper"),placeHolderTitle:e.querySelector(".placeholder-title"),placeHolderMessageBox:e.querySelector(".message-box"),image:e.querySelector(".image-wrapper img"),overlay:{container:e.querySelector(".image-overlay"),deleteButton:e.querySelector(".image-overlay .delete-button"),downloadButton:e.querySelector(".image-overlay .download-button")},errorOverlay:{container:e.querySelector(".error-overlay"),message:e.querySelector(".error-overlay .error-message")}})},N=new WeakMap,te=function(){this.acceptTypes="image/jpeg,image/jpg,image/png,image/svg+xml",o(this,n,j).call(this,"empty"),o(this,n,re).call(this)},ae=function(){i(this,c).placeHolderWrapper.addEventListener("click",this.openImageSelector.bind(this)),i(this,c).image.addEventListener("click",this.openImageSelector.bind(this)),i(this,c).overlay.container.addEventListener("click",this.openImageSelector.bind(this)),i(this,c).overlay.deleteButton.addEventListener("click",o(this,n,ge).bind(this)),i(this,c).overlay.downloadButton.addEventListener("click",o(this,n,be).bind(this))},re=function(){u(this,m,document.createElement("input")),i(this,m).type="file",i(this,m).accept=this.acceptTypes,i(this,m).addEventListener("change",e=>o(this,n,oe).call(this,e))},ie=function(e,a){switch(e){case"required":this.required=a===""||a=="true";break;case"label":i(this,c).placeHolderTitle&&(i(this,c).placeHolderTitle.innerHTML=a);break;case"multiple":this.multiple=a==="true";break;case"message":i(this,c).placeHolderMessageBox.innerHTML=a}},ne=function(e){const a=new CustomEvent("imageSelected",{detail:{files:e}});this.dispatchEvent(a)},oe=function(e){const a=e.target.files;if(a&&(a==null?void 0:a.length)>0){o(this,n,ne).call(this,a);const s=a[0];i(this,m).value=null,this.selectImageByFile(s)}},le=function(e){u(this,v,e),o(this,n,U).call(this)},se=function(e){const a=new CustomEvent("maxSizeExceed",{detail:{file:e},cancelable:!1});this.dispatchEvent(a)},ce=function(e){o(this,n,j).call(this,"uploading"),this.bridge.uploader(e,this.config,this.onProgressImageUpload.bind(this)).then(a=>o(this,n,de).call(this,a)).catch(()=>o(this,n,ue).call(this))},de=function(e){const a=this.value;o(this,n,j).call(this,"uploaded"),this.value=e,o(this,n,U).call(this).defaultPrevented&&(this.value=a)},U=function(){const e=new Event("change",{bubbles:!0,composed:!0,cancelable:!1});return this.dispatchEvent(e),e},ue=function(){this.value?o(this,n,j).call(this,"downloaded"):o(this,n,j).call(this,"empty"),i(this,m).value=""},G=function(e){o(this,n,j).call(this,"downloaded"),this.imageBase64Value=e,i(this,c).image.setAttribute("src",e)},j=function(e){i(this,c).webComponent.setAttribute("status",e),u(this,P,e)},he=function(e){i(this,c).errorOverlay.message.innerHTML=e,i(this,c).errorOverlay.container.style.display="flex",setTimeout(()=>{i(this,c).errorOverlay.message.innerHTML="",i(this,c).errorOverlay.container.style.display="none"},2e3)},pe=function(){const e=[];return this.required&&e.push({validator:({file:s,value:l})=>s!==null||l!=null,message:"تصویر حتما باید انتخاب شود",stateType:"valueMissing"}),i(this,x)&&e.push({validator:({file:a})=>a==null||a.size<=i(this,x),message:"حجم فایل بیشتر از حد مجاز است",stateType:"rangeOverflow"}),e},me=function(e){if(e.isAllValid)i(this,f).setValidity({},"");else{const a={};let s="";e.validationList.forEach(l=>{l.isValid||(l.validation.stateType&&(a[l.validation.stateType]=!0),s==""&&(s=l.message))}),i(this,f).setValidity(a,s)}},ge=function(e){e.stopPropagation(),o(this,n,K).call(this,null),o(this,n,U).call(this)},be=function(e){e.stopPropagation();const a=i(this,c).image.getAttribute("src"),s=a.match(/[^:/]\w+(?=;|,)/)[0],l=document.createElement("a");l.href=a,l.download="Image."+s,l.click()},K=function(e){u(this,C,e),e!=null?e instanceof File?(u(this,v,e),A.ExtractBase64ImageFromFile(e).then(o(this,n,G).bind(this))):this.bridge.downloader(e,this.config).then(o(this,n,G).bind(this)):(u(this,v,null),o(this,n,j).call(this,"empty"))},A);!customElements.get("jb-image-input")&&window.customElements.define("jb-image-input",je);let xe=Y.forwardRef((t,r)=>{let e=g.useRef(null),[a,s]=g.useState(0);return g.useImperativeHandle(r,()=>e?e.current:{},[e]),g.useEffect(()=>{s(a+1)},[e.current]),g.useEffect(()=>{t.config&&e.current&&(e.current.config=t.config)},[t.config]),g.useEffect(()=>{t.bridge&&e.current&&(e.current.bridge=t.bridge)},[t.bridge]),g.useEffect(()=>{var l,w;t.multiple?(l=e.current)==null||l.setAttribute("multiple","true"):(w=e.current)==null||w.removeAttribute("multiple")},[t.multiple]),g.useEffect(()=>{t.value!==void 0&&e.current&&(e.current.value=t.value)},[t.value]),g.useEffect(()=>{var l;t.file&&((l=e.current)==null||l.selectImageByFile(t.file))},[t.file]),g.useEffect(()=>{t.acceptTypes&&e.current&&(e.current.acceptTypes=t.acceptTypes)},[t.acceptTypes]),g.useEffect(()=>{t.maxFileSize!==void 0&&e.current&&(e.current.maxFileSize=t.maxFileSize)},[t.maxFileSize]),B(e,"load",t.onLoad,!0),B(e,"init",t.onInit,!0),B(e,"change",t.onChange),B(e,"imageSelected",t.onImageSelected),B(e,"maxSizeExceed",t.onMaxSizeExceed),Y.createElement("jb-image-input",{ref:e,class:t.className||"",label:t.label,"upload-type":t.uploadType||"AUTO",required:t.required,name:t.name,message:t.message||""},t.children)});xe.displayName="JBImageInput";export{xe as l};
