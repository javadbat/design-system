import{r as u,R as G}from"./index-DP23ewiS.js";import"./jb-date-input-D9cLifPI.js";import{c as H}from"./index-C-kj9kL4.js";var k;function s(e,v,l,t=!1){let n=u.useCallback(r=>{e.current&&typeof l=="function"&&l(r)},[e,l]);u.useEffect(()=>{let r=e.current;return r&&r.addEventListener(v,n,{passive:t,capture:!1}),function(){r&&r.removeEventListener(v,n,{passive:t,capture:!1})}},[e,v,l,t])}function B(e){return e.substring(5,7)}function P(e){return e.substring(0,4)}function U(e){let[v,l]=u.useState("    /  /  "),t=u.useRef(null);u.useEffect(()=>{t.current&&setTimeout(()=>{e.ref.current.setSelectionRange(t.current.selectionStart,t.current.selectionEnd),t.current=null},0)},[v,t.current]);let n=()=>{if(t.current===null){let r=(function(i){let o=i.selectionStart;if(o){let A=P(i.inputValue).trim().length,D=B(i.inputValue).trim().length,f=i.inputValue.substring(8,10).trim().length;if(A<o&&(o<=4||D==0&&f==0))return A;if(o>4&&(o<=7&&D+5<o||f==0&&D<2))return D+5;if(f+8<o&&o>7&&o<=10)return f+8}return null})({inputValue:v,selectionStart:e.ref.current.selectionStart});r!=null&&r!==e.ref.current.selectionStart&&e.ref.current.setSelectionRange(r,r)}};return s(e.ref,"beforeinput",function(r){t.current=(function(i){let{dateInputType:o,selection:A,event:{data:D,inputType:f}}=i,T=A.start,V=T,L=i.value;return D&&H(i.event.data||"").replace(/[^\u06F0-\u06F90-9/]/g,"").split("").forEach((d,E)=>{var p,c;let m,a=T+E;if(!/[\u06F0-\u06F90-9/]/g.test(d))return;a!=4&&a!=7||(d=="/"&&N(a+1),a++);let b=!1;if(d=="/")return;let w=Number(d);a==5&&w>1&&(R("0",a),a++);let F=(p=L,m=!1,(c=a)==5&&w==1&&p[6]>"2"&&(m=!0),c==6&&w>2&&p[5]=="1"&&(m=!0),c==6&&w==0&&p[5]=="0"&&(m=!0),c==5&&w==0&&p[4]=="0"&&(m=!0),{isIgnoreChar:m,caretPos:c}),x=(function(J,I,h,y,C){let g=!1;if(h==8&&I>3&&(C("0",h),h++),h==9&&I>1&&y[8]=="3"&&(g=!0),h==9&&I==0&&y[8]=="0"&&(g=!0),h==8&&I==0&&y[9]=="0"&&(g=!0),!g){let S=B(y),M=Number(S);if(h==9&&y[8]=="3"&&I>0&&M>6&&(g=!0),h==8&&I==3){if(M==12){let j=Number(P(y));!Number.isNaN(j)&&[1,5,9,13,17,22,26,30].includes(j%33)||(g=!0)}y[9]>"0"&&(S.length==2&&parseInt(y)>6&&C("0",9),S.length==2&&M<7&&y[9]>"1"&&C("1",9))}}return{isIgnoreChar:g,caretPos:h}})(o,w,a=F.caretPos,L,R);a=x.caretPos,(b=b||x.isIgnoreChar||F.isIgnoreChar)||(R(d,a),N(a+1))}),f!="deleteContentBackward"&&f!="deleteContentForward"&&f!="delete"&&f!="deleteByCut"&&f!="deleteByDrag"||(function(d,E,p,c,m){let a=0;d=="deleteContentBackward"&&(a=E!==p?0:-1);for(let b=E;b<=p;b++)c(" ",b+a);m(E+a)})(f,A.start,A.end,R,N),{value:L,selectionStart:V,selectionEnd:V};function R(d,E){L=(function(p,c,m,a){if(c!=4&&c!=7||(p="/"),c>9||c<0)return m;let b=m.split("");return b[c]=p,b.join("")})(d,E,L)}function N(d){V=d}})({dateInputType:e.dateInputType,selection:{start:e.ref.current.selectionStart,end:e.ref.current.selectionEnd},value:v,event:{inputType:r.inputType,data:r.data}}),r.preventDefault(),l(t.current.value),e.ref.current.setSelectionRange(t.current.selectionStart,t.current.selectionEnd)}),{value:v,setValue:l,onFocus:()=>{n()},onClick:()=>{n()},onChange:()=>{}}}(k={}).jalali="JALALI",k.gregorian="GREGORIAN";let q=u.forwardRef((e,v)=>{let l,t=u.useRef(null);return u.useImperativeHandle(v,()=>t?t.current:{},[t]),l=u.useRef([]),u.useEffect(()=>{var n,r;e.format&&(e.format!==((n=t.current)==null?void 0:n.valueFormat)&&((r=t.current)==null||r.setAttribute("format",e.format)),l.current.length>0&&(l.current.forEach(i=>{i()}),l.current=[]))},[e.format]),u.useEffect(()=>{var n,r;e.max&&(e.format&&e.format!==((n=t.current)==null?void 0:n.valueFormat)?l.current.push(()=>{var i;e.max&&((i=t.current)==null||i.setMaxDate(e.max))}):(r=t.current)==null||r.setMaxDate(e.max))},[e.max]),u.useEffect(()=>{var n,r;e.name?(n=t==null?void 0:t.current)==null||n.setAttribute("name",e.name||""):(r=t==null?void 0:t.current)==null||r.removeAttribute("name")},[e.name]),u.useEffect(()=>{var n,r;e.min&&(e.format&&e.format!==((n=t.current)==null?void 0:n.valueFormat)?l.current.push(()=>{var i;e.min&&((i=t.current)==null||i.setMinDate(e.min))}):(r=t.current)==null||r.setMinDate(e.min))},[e.min]),u.useEffect(()=>{t.current&&e.value&&(t.current.value=e.value)},[e.value]),u.useEffect(()=>{t.current&&t.current.setAttribute("message",e.message||"")},[e.message]),u.useEffect(()=>{t.current&&Array.isArray(e.jalaliMonthList)&&t.current.setMonthList("JALALI",e.jalaliMonthList)},[e.jalaliMonthList]),u.useEffect(()=>{t.current&&Array.isArray(e.gregorianMonthList)&&t.current.setMonthList("GREGORIAN",e.gregorianMonthList)},[e.gregorianMonthList]),u.useEffect(()=>{t.current&&e.placeholder!==void 0&&(t.current.placeholder=e.placeholder)},[e.placeholder]),u.useEffect(()=>{t.current&&e.overflowHandler!==void 0&&(t.current.elements.popover.overflowHandler=e.overflowHandler)},[e.overflowHandler]),u.useEffect(()=>{t.current&&e.overflowRef!==void 0&&(t.current.elements.popover.overflowDom=e.overflowRef.current)},[e.overflowRef]),u.useEffect(()=>{t.current&&Array.isArray(e.validationList)&&(t.current.validation.list=e.validationList)},[e.validationList]),u.useEffect(()=>{t.current&&e.direction&&t.current.setAttribute("direction",e.direction)},[e.direction]),u.useEffect(()=>{t.current&&(e.required?t.current.required=!0:t.current.required=!1)},[e.required,t.current]),u.useEffect(()=>{var n;typeof e.calendarDefaultDateView=="object"&&e.calendarDefaultDateView.year&&e.calendarDefaultDateView.month&&((n=t.current)==null||n.setCalendarDefaultDateView(e.calendarDefaultDateView.year,e.calendarDefaultDateView.month,e.calendarDefaultDateView.dateType))},[e.calendarDefaultDateView]),u.useEffect(()=>{var n,r;e.showPersianNumber?(n=t.current)==null||n.setAttribute("show-persian-number","true"):(r=t.current)==null||r.removeAttribute("show-persian-number")},[e.showPersianNumber]),u.useEffect(()=>{var n;typeof e.disabled=="boolean"&&((n=t==null?void 0:t.current)==null||n.setAttribute("disabled",`${e.disabled}`))},[e.disabled]),u.useEffect(()=>{var n,r;e.error?(n=t==null?void 0:t.current)==null||n.setAttribute("error",e.error):(r=t==null?void 0:t.current)==null||r.removeAttribute("error")},[e.error]),u.useEffect(()=>{t!=null&&t.current&&(t.current.isAutoValidationDisabled=!!e.isAutoValidationDisabled)},[e.isAutoValidationDisabled]),s(t,"load",e.onLoad,!0),s(t,"init",e.onInit,!0),s(t,"invalid",e.onInvalid,!0),s(t,"change",e.onChange,!0),s(t,"beforeinput",e.onBeforeInput,!1),s(t,"input",e.onInput,!0),s(t,"keyup",e.onKeyUp,!0),s(t,"keydown",e.onKeyDown,!1),s(t,"keypress",e.onKeyPress,!0),s(t,"select",e.onSelect,!0),s(t,"focus",e.onFocus,!0),s(t,"blur",e.onBlur,!0),G.createElement("jb-date-input",{style:e.style,class:e.className?e.className:"",label:e.label,"value-type":e.valueType?e.valueType:"GREGORIAN",ref:t,"input-type":e.inputType?e.inputType:"JALALI"},e.children)});q.displayName="JBDateInput";export{q as m,U as p};
